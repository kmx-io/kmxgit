#!/bin/sh
## kmxgit
## Copyright 2022 kmx.io <contact@kmx.io>
##
## Permission is hereby granted to use this software granted
## the above copyright notice and this permission paragraph
## are included in all copies and substantial portions of this
## software.
##
## THIS SOFTWARE IS PROVIDED "AS-IS" WITHOUT ANY GUARANTEE OF
## PURPOSE AND PERFORMANCE. IN NO EVENT WHATSOEVER SHALL THE
## AUTHOR BE CONSIDERED LIABLE FOR THE USE AND PERFORMANCE OF
## THIS SOFTWARE.

LIBBSD_CFLAGS="$(pkg-config libbsd-overlay --cflags)"
LIBBSD_LIBS="$(pkg-config libbsd-overlay --libs)"
LIBGIT2_CFLAGS="$(pkg-config libgit2 --cflags)"
LIBGIT2_LIBS="$(pkg-config libgit2 --libs)"

CFLAGS="$CFLAGS $LIBBSD_CFLAGS $LIBGIT2_CFLAGS"
LIBS="$LIBBSD_LIBS $LIBGIT2_LIBS"

if [ -f /usr/include/alloca.h ]; then
    CFLAGS="$CFLAGS -DHAVE_ALLOCA_H"
fi

echo "# This file was generate by configure." > config.mk
echo "CFLAGS += $CFLAGS" >> config.mk
echo "LIBS += $LIBS" >> config.mk
